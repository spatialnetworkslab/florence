import robustPointInPolygon from 'robust-point-in-polygon'

export default function (point, geometry) {
  switch (geometry.type) {
    case 'Polygon': return pointInPolygon(point, geometry)
    case 'MultiPolygon': return pointInMultiPolygon(point, geometry)
  }
}

function pointInPolygon (point, geometry) {
  let coordinates = geometry.coordinates
  let outerRing = coordinates[0]

  if (!pointInRing(point, outerRing)) return false

  for (let i = 1; i < coordinates.length; i++) {
    let hole = coordinates[i]

    if (pointInRing(point, hole)) return false
  }

  return true
}

function pointInMultiPolygon (point, geometry) {
  let coordinates = geometry.coordinates

  for (let i = 0; i < coordinates.length; i++) {
    let polygon = coordinates[i]

    if (pointInPolygon(point, polygon)) return true
  }

  return false
}

function pointInRing (point, coordinates) {
  return robustPointInPolygon(coordinates, point) !== 1
}
